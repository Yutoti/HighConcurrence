# HighConcurrence
深入扩展先前做的电商项目，添加秒杀商品的模块
***
# 一 高并发会导致哪些问题
## 1. 服务器请求数过载
- 每台服务器能够承载的请求的个数是一定的，请求数太多，服务器处理不过来。（单台服务器能够承受多少的并发量？C10K问题。具体数目不太确定，但肯定是无法满足百万以上的量级的）
## 2. 快速响应
- 一个Web请求可以简单地理解成从浏览器发出，经过应用服务器处理，再请求数据库服务器。这之间有网络延迟（北京-上海约15ms），还有应用服务器可能发生的GC操作（一次约50ms），这些对于TPS来说影响都很大。
## 3. 数据一致性
- 多个请求并发访问数据库，可能出现脏读、不可重复读、幻读等问题。
# 二 各个问题的可选解决方案
## 1. 服务器请求数过载

### (1) 尽量使用静态资源或动静分离

&nbsp; &nbsp; **减少.jsp文件的使用，减少服务器对jsp文件的解析；也减少jvm内存占用**

&nbsp; &nbsp; **动静分离：使用NFS文件服务器，当访问静态资源时则访问NFS，当访问动态资源时则访问服务器**

### (2) 负载均衡

&nbsp; &nbsp; 当单台服务器无法满足高并发请求要求时，可以考虑将应用拆分部署到多台服务器上，这时就需要考虑在集群设备前加负载均衡处理，实现流量分发。

**负载均衡是指将负载（如请求等）进行平衡，分摊到各个处理单元上执行。**

负载均衡技术主要有两类：

&nbsp; &nbsp; **1）软件负载均衡**

&nbsp; &nbsp; 软件负载均衡常用的软件是*Nginx*，底层用的技术包括DNS负载均衡、HTTP负载均衡、IP负载均衡、链路层负载均衡等。

&nbsp; &nbsp; 2）硬件负载均衡

&nbsp; &nbsp; 一般软件负载均衡支持到5万级并发已经很困难了，可以考虑使用负载均衡服务器。较昂贵。

### (3) 控制请求数量

&nbsp; &nbsp; 为访问量较大的API接口设置信号量，能够拿到信号量的就执行，不能的就返回异常。

## 2. 快速响应

先前说到应用服务器和数据库服务器之间会有网络延迟的问题，这一处可以采用数据库优化（使用存储过程）、使用缓存来解决；应用服务器的GC操作也会大量降低TPS，这一处可以用JVM优化来解决；另外浏览器和应用服务器之间的网络延迟也可以降低，通过使用CDN服务器（华为就有）。

### （1）数据库优化

使用存储过程可以减少数据库IO次数，降低网络延迟。

数据库优化包含很多方面，不仅能解决网络延迟的问题，在其他方面优化还可以降低数据库本身操作的时间：

&nbsp; &nbsp; 1）SQL语句优化 

&nbsp; &nbsp; 2）索引优化

&nbsp; &nbsp; 3）表结构优化

### （2）使用缓存

### （3）JVM优化

### （4）CDN服务器

## 3. 数据一致性
# 三 各个解决方案的优缺点，适用场合

# 四 最终选定的方案
